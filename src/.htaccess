############################################
# Angular SPA routing
############################################
<IfModule mod_rewrite.c>
  RewriteEngine On

  # Do not rewrite existing folder
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Fallback SPA to index.html
  RewriteRule ^ index.html [L]
</IfModule>


############################################
# Headers HTTP â€“ PWA / Service Worker
############################################
<IfModule mod_headers.c>

  # index.html : No cache (only SW is responsible)
  <Files "index.html">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
  </Files>

  # Service Worker & manifest : no long cache
  <FilesMatch "(ngsw-worker\.js|ngsw\.json|manifest\.webmanifest)$">
    Header set Cache-Control "no-cache"
  </FilesMatch>

  # Assets hashed assets : very long cache
  <FilesMatch "\.(js|css|png|jpg|jpeg|gif|svg|webp|mp3|mp4)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>

</IfModule>

